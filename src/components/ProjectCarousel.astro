---
const projects = [
  {
    id: 1,
    title: "LLM DB CONNECTOR",
    tech: "FastAPI,PostgreSQL",
    url: "https://github.com/markush0f/LLM-DB-CONECTOR",
    image: "projects/llmdb.png",
  },
  {
    id: 2,
    title: "Virtual Assistant",
    tech: "Python, PostgreSQL, Docker, Alembic",
    url: "https://github.com/markush0f/virtual-assistant",
    image: "projects/assistant.png",
  },
  {
    id: 3,
    title: "TrainTrack",
    tech: "VueJS, Django, MySQL, TailwindCSS",
    url: "https://github.com/markush0f/traintrack",
    image: "projects/train-track.png",
  },
];
---

<div class="w-full">
  <div class="relative max-w-2xl mx-auto">
    <!-- Title -->
    <div class="mb-6">
      <h3 class="text-2xl md:text-3xl font-bold text-white mb-2">
        More Projects
      </h3>
      <div class="w-16 h-0.5 bg-blue-500 rounded-full"></div>
    </div>

    <!-- Carousel Container -->
    <div class="relative group">
      <div class="absolute -inset-0.5 bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl opacity-0 group-hover:opacity-20 blur transition duration-500"></div>
      
      <div
        class="carousel-container relative h-64 md:h-80 lg:h-96 rounded-2xl overflow-hidden cursor-pointer border border-gray-800 group-hover:border-gray-700 transition-all duration-300"
        id="carouselContainer"
      >
        {
          projects.map((project, index) => (
            <div
              class={`carousel-slide absolute inset-0 transition-all duration-500 rounded-2xl ${index === 0 ? "opacity-100" : "opacity-0"}`}
              data-index={index}
              data-url={project.url}
            >
              <img
                src={project.image}
                alt={project.title}
                class="absolute inset-0 w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"
              />

              <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/30 to-transparent pointer-events-none transition-all duration-300 group-hover:from-black/90" />

              <div class="absolute bottom-0 left-0 right-0 p-6 md:p-8 text-white pointer-events-none">
                <div class="transform transition-all duration-300 group-hover:translate-y-0 translate-y-2">
                  <h4 class="text-xl md:text-2xl font-bold mb-2">
                    {project.title}
                  </h4>
                  <p class="text-sm md:text-base text-blue-300 font-medium">
                    {project.tech}
                  </p>
                </div>
              </div>

              <!-- View Project overlay -->
              <div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none">
                <div class="bg-blue-500 text-white px-6 py-3 rounded-full font-semibold flex items-center gap-2 transform translate-y-4 group-hover:translate-y-0 transition-transform duration-300">
                  <span>View Project</span>
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                  </svg>
                </div>
              </div>
            </div>
          ))
        }

        <!-- Navigation Buttons -->
        <button
          id="prevBtn"
          class="absolute left-4 top-1/2 -translate-y-1/2 text-white/80 hover:text-white transition-all duration-300 bg-black/40 hover:bg-black/70 hover:scale-110 rounded-full p-3 z-10 backdrop-blur-sm"
          aria-label="Previous project"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="w-5 h-5"
          >
            <path d="m15 18-6-6 6-6"></path>
          </svg>
        </button>

        <button
          id="nextBtn"
          class="absolute right-4 top-1/2 -translate-y-1/2 text-white/80 hover:text-white transition-all duration-300 bg-black/40 hover:bg-black/70 hover:scale-110 rounded-full p-3 z-10 backdrop-blur-sm"
          aria-label="Next project"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="w-5 h-5"
          >
            <path d="m9 18 6-6-6-6"></path>
          </svg>
        </button>
      </div>

      <!-- Indicators -->
      <div class="flex justify-center gap-2 mt-6" id="indicators">
        {
          projects.map((_, index) => (
            <button
              class={`indicator h-1.5 rounded-full transition-all duration-300 hover:scale-125 ${index === 0 ? "w-8 bg-blue-500" : "w-1.5 bg-gray-600 hover:bg-gray-500"}`}
              data-index={index}
              aria-label={`Go to project ${index + 1}`}
            />
          ))
        }
      </div>
    </div>
  </div>
</div>

<script>
  let currentIndex = 0;
  const slides = document.querySelectorAll(".carousel-slide");
  const indicators = document.querySelectorAll(".indicator");
  const container = document.getElementById("carouselContainer");
  const totalSlides = slides.length;

  function updateCarousel() {
    slides.forEach((slide, index) => {
      slide.classList.toggle("opacity-100", index === currentIndex);
      slide.classList.toggle("opacity-0", index !== currentIndex);
    });

    indicators.forEach((indicator, index) => {
      if (index === currentIndex) {
        indicator.classList.remove("w-1.5", "bg-gray-600");
        indicator.classList.add("w-8", "bg-blue-500");
      } else {
        indicator.classList.remove("w-8", "bg-blue-500");
        indicator.classList.add("w-1.5", "bg-gray-600");
      }
    });
  }

  // Click en el contenedor para redirigir
  container?.addEventListener("click", (e) => {
    const target = e.target as HTMLElement;
    if (target.closest("#prevBtn") || target.closest("#nextBtn")) {
      return;
    }

    const currentSlide = slides[currentIndex] as HTMLElement;
    const url = currentSlide.dataset.url;
    if (url) {
      window.open(url, "_blank");
    }
  });

  document.getElementById("prevBtn")?.addEventListener("click", (e) => {
    e.stopPropagation();
    currentIndex = (currentIndex - 1 + totalSlides) % totalSlides;
    updateCarousel();
  });

  document.getElementById("nextBtn")?.addEventListener("click", (e) => {
    e.stopPropagation();
    currentIndex = (currentIndex + 1) % totalSlides;
    updateCarousel();
  });

  indicators.forEach((indicator, index) => {
    indicator.addEventListener("click", () => {
      currentIndex = index;
      updateCarousel();
    });
  });

  // Auto-play (opcional, descomenta si quieres)
  // let autoplayInterval = setInterval(() => {
  //   currentIndex = (currentIndex + 1) % totalSlides;
  //   updateCarousel();
  // }, 5000);

  // Pausar autoplay al hover
  // container?.addEventListener("mouseenter", () => {
  //   clearInterval(autoplayInterval);
  // });

  // container?.addEventListener("mouseleave", () => {
  //   autoplayInterval = setInterval(() => {
  //     currentIndex = (currentIndex + 1) % totalSlides;
  //     updateCarousel();
  //   }, 5000);
  // });
</script>